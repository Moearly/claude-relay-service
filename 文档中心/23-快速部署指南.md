# 🚀 快速配置指南

## 📦 已完成的部署

✅ **前端网站已部署到 Vercel**
- 当前地址: https://commercial-website-ql1qg8fv9-martn-leis-projects.vercel.app
- API 配置: `https://api.codefog.cc`

## 🎯 配置自定义域名 (codefog.cc)

### 方式一：自动配置（推荐）⚡

```bash
# 1. 设置环境变量
export CLOUDFLARE_API_TOKEN="你的API Token"      # 从 Cloudflare 获取
export CLOUDFLARE_ZONE_ID="你的Zone ID"          # 从 Cloudflare 获取
export API_SERVER_IP="你的服务器IP"               # 后端服务器的公网 IP

# 2. 运行配置脚本
cd /home/leiyi/codeSpace/ApiRelay
./scripts/setup-dns.sh
```

### 方式二：交互式配置

```bash
cd /home/leiyi/codeSpace/ApiRelay
./scripts/setup-dns.sh
# 脚本会提示你输入所需信息
```

### 方式三：手动配置

如果不想使用脚本，请查看 [CLOUDFLARE_SETUP.md](./CLOUDFLARE_SETUP.md) 获取详细的手动配置步骤。

## 📋 获取必需信息

### 1. Cloudflare API Token

1. 访问: https://dash.cloudflare.com/profile/api-tokens
2. 点击 **Create Token**
3. 使用 **Edit zone DNS** 模板
4. 选择域名 `codefog.cc`
5. 复制生成的 Token

### 2. Cloudflare Zone ID

1. 访问: https://dash.cloudflare.com
2. 选择 `codefog.cc` 域名
3. 在页面右下角找到 **Zone ID**
4. 点击复制

### 3. API 服务器 IP

```bash
# 在你的服务器上运行
curl ifconfig.me
```

## ✅ 配置完成后

### 1. 在 Vercel 添加域名

访问: https://vercel.com/martn-leis-projects/commercial-website/settings/domains

添加:
- `codefog.cc`
- `www.codefog.cc` (可选)

### 2. 验证访问

等待 5-30 分钟后访问:
- **前端**: https://codefog.cc
- **API**: https://api.codefog.cc/health

### 3. 检查 DNS 传播

```bash
# 命令行检查
dig codefog.cc
dig www.codefog.cc
dig api.codefog.cc

# 或访问在线工具
# https://www.whatsmydns.net/
```

## 🔧 后端服务器配置

确保后端服务正常运行:

```bash
# SSH 连接到服务器
ssh user@your-server-ip

# 进入项目目录
cd /path/to/claude-relay-service

# 检查服务状态
npm run service:status

# 如果未运行，启动服务
npm run service:start:daemon

# 查看日志
npm run service:logs
```

### 配置 CORS

编辑 `.env` 文件，添加:

```bash
CORS_ORIGIN=https://codefog.cc,https://www.codefog.cc
```

重启服务:
```bash
npm run service:restart
```

## 📊 DNS 记录概览

配置完成后的 DNS 记录:

| 记录类型 | 名称 | 指向 | 代理状态 | 用途 |
|---------|------|------|---------|------|
| CNAME | @ | cname.vercel-dns.com | ⚪ DNS only | 主域名 |
| CNAME | www | cname.vercel-dns.com | ⚪ DNS only | WWW |
| A | api | [服务器IP] | 🟠 Proxied | API |

## 🎉 架构图

```
用户
  ↓
codefog.cc → Cloudflare DNS → Vercel CDN → Next.js 前端
  ↓
api.codefog.cc → Cloudflare Proxy → 你的服务器 → Claude Relay Service
```

## 📞 需要帮助？

- 详细配置: [CLOUDFLARE_SETUP.md](./CLOUDFLARE_SETUP.md)
- 项目文档: [README.md](./README.md)

---

**一切准备就绪！** 🚀

现在你可以运行自动配置脚本来完成域名配置。

